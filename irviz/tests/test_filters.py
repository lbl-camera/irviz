import pytest

from irviz.background_filters import emsc_background_single_spectrum, gpr_based_background_single_spectrum

tested_filters = [gpr_based_background_single_spectrum, emsc_background_single_spectrum]

_test_parameter_set = {'name': 'Alpha',
                       'map_mask': None,
                       'values': {'rbf_start': 1000, 'rbf_low': 500, 'rbf_high': 100000000, 'C_start': 1, 'C_low': 1e-06,
                                  'C_high': 10000},
                       'anchor_points': [{'name': 'Anchor #1', 'x': 655.68, 'y': -0.009089183993637562},
                                         {'name': 'Anchor #2', 'x': 840.81, 'y': 0.0049593825824558735},
                                         {'name': 'Anchor #3', 'x': 1783.83, 'y': -0.04377490654587746},
                                         {'name': 'Anchor #7', 'x': 2102.03, 'y': -0.005395716987550259},
                                         {'name': 'Anchor #8', 'x': 2439.51, 'y': 0.016786040738224983},
                                         {'name': 'Anchor #4', 'x': 2796.28, 'y': 0.017069589346647263},
                                         {'name': 'Anchor #5', 'x': 3693.01, 'y': -0.006616990081965923},
                                         {'name': 'Anchor #6', 'x': 3990, 'y': -0.015324528329074383}],
                       'anchor_regions': [{'name': 'Region #1', 'region_min': 1801.19, 'region_max': 2757.71},
                                          {'name': 'Region #2', 'region_min': 3689.16, 'region_max': 3974.57},
                                          {'name': 'Region #4', 'region_min': 659.54, 'region_max': 848.53}]
                       }

_test_data_x = [649.89325,651.8217,653.7502,655.67865,657.6071,659.5356,661.46405,663.3925,665.321,667.24945,669.1779,671.1064,673.03485,674.9633,676.8918,678.82025,680.7487,682.6772,684.60565,686.5341,688.4626,690.39105,692.3195,694.248,696.17645,698.1049,700.0334,701.96185,703.8903,705.8188,707.74725,709.6757,711.6042,713.53265,715.4611,717.3896,719.31805,721.2465,723.175,725.10345,727.0319,728.9604,730.88885,732.8173,734.7458,736.67426,738.6027,740.5312,742.45966,744.3881,746.3166,748.24506,750.1735,752.102,754.03046,755.9589,757.8874,759.81586,761.7443,763.6728,765.60126,767.5297,769.4582,771.38666,773.3151,775.2436,777.17206,779.1005,781.029,782.95746,784.8859,786.8144,788.74286,790.6713,792.5998,794.52826,796.4567,798.3852,800.31366,802.2421,804.1706,806.09906,808.0275,809.956,811.88446,813.8129,815.7414,817.66986,819.5983,821.5268,823.45526,825.3837,827.3122,829.24066,831.1691,833.0976,835.02606,836.9545,838.883,840.81146,842.7399,844.6684,846.59686,848.5253,850.4538,852.38226,854.3107,856.2392,858.16766,860.0961,862.0246,863.95306,865.88153,867.81,869.73846,871.66693,873.5954,875.52386,877.45233,879.3808,881.30927,883.23773,885.1662,887.09467,889.02313,890.9516,892.88007,894.80853,896.737,898.66547,900.59393,902.5224,904.45087,906.37933,908.3078,910.23627,912.16473,914.0932,916.02167,917.95013,919.8786,921.80707,923.73553,925.664,927.59247,929.52094,931.4494,933.37787,935.30634,937.2348,939.16327,941.09174,943.0202,944.94867,946.87714,948.8056,950.7341,952.66254,954.591,956.5195,958.44794,960.3764,962.3049,964.23334,966.1618,968.0903,970.01874,971.9472,973.8757,975.80414,977.7326,979.6611,981.58954,983.518,985.4465,987.37494,989.3034,991.2319,993.16034,995.0888,997.0173,998.94574,1000.8742,1002.8027,1004.73114,1006.6596,1008.5881,1010.51654,1012.445,1014.3735,1016.30194,1018.2304,1020.1589,1022.08734,1024.0157,1025.9442,1027.8727,1029.8011,1031.7296,1033.6581,1035.5865,1037.515,1039.4435,1041.372,1043.3004,1045.2289,1047.1573,1049.0858,1051.0143,1052.9427,1054.8712,1056.7997,1058.7281,1060.6566,1062.5851,1064.5135,1066.442,1068.3705,1070.299,1072.2274,1074.1559,1076.0844,1078.0128,1079.9413,1081.8698,1083.7982,1085.7267,1087.6552,1089.5836,1091.5121,1093.4406,1095.369,1097.2975,1099.226,1101.1544,1103.0829,1105.0114,1106.9398,1108.8683,1110.7968,1112.7252,1114.6537,1116.5822,1118.5106,1120.4391,1122.3676,1124.296,1126.2245,1128.153,1130.0814,1132.0099,1133.9384,1135.8668,1137.7953,1139.7238,1141.6522,1143.5807,1145.5092,1147.4376,1149.3661,1151.2946,1153.223,1155.1515,1157.08,1159.0084,1160.9369,1162.8654,1164.7938,1166.7223,1168.6508,1170.5792,1172.5077,1174.4362,1176.3646,1178.2931,1180.2216,1182.15,1184.0785,1186.007,1187.9354,1189.8639,1191.7924,1193.7208,1195.6493,1197.5778,1199.5062,1201.4347,1203.3632,1205.2916,1207.2201,1209.1486,1211.077,1213.0055,1214.934,1216.8624,1218.7909,1220.7194,1222.6478,1224.5763,1226.5048,1228.4332,1230.3617,1232.2902,1234.2186,1236.1471,1238.0756,1240.004,1241.9325,1243.861,1245.7894,1247.7179,1249.6464,1251.5748,1253.5033,1255.4318,1257.3602,1259.2887,1261.2172,1263.1456,1265.0741,1267.0026,1268.931,1270.8595,1272.788,1274.7164,1276.6449,1278.5734,1280.5018,1282.4303,1284.3588,1286.2872,1288.2157,1290.1442,1292.0726,1294.0011,1295.9296,1297.858,1299.7865,1301.715,1303.6434,1305.5719,1307.5004,1309.4288,1311.3573,1313.2858,1315.2142,1317.1427,1319.0712,1320.9996,1322.9281,1324.8566,1326.785,1328.7135,1330.642,1332.5704,1334.4989,1336.4274,1338.3558,1340.2843,1342.2128,1344.1412,1346.0697,1347.9982,1349.9266,1351.8551,1353.7836,1355.712,1357.6405,1359.569,1361.4974,1363.4259,1365.3544,1367.2828,1369.2113,1371.1398,1373.0682,1374.9967,1376.9252,1378.8536,1380.7821,1382.7106,1384.639,1386.5675,1388.496,1390.4244,1392.3529,1394.2814,1396.2098,1398.1383,1400.0668,1401.9952,1403.9237,1405.8522,1407.7806,1409.7091,1411.6376,1413.566,1415.4945,1417.423,1419.3514,1421.2799,1423.2084,1425.1368,1427.0653,1428.9938,1430.9222,1432.8507,1434.7792,1436.7076,1438.6361,1440.5646,1442.493,1444.4215,1446.35,1448.2784,1450.2069,1452.1354,1454.0638,1455.9923,1457.9208,1459.8492,1461.7777,1463.7062,1465.6346,1467.5631,1469.4916,1471.42,1473.3485,1475.277,1477.2054,1479.1339,1481.0624,1482.9908,1484.9193,1486.8478,1488.7762,1490.7047,1492.6332,1494.5616,1496.4901,1498.4186,1500.347,1502.2755,1504.204,1506.1324,1508.0609,1509.9894,1511.9178,1513.8463,1515.7748,1517.7032,1519.6317,1521.5602,1523.4886,1525.4171,1527.3456,1529.274,1531.2025,1533.131,1535.0594,1536.9879,1538.9164,1540.8448,1542.7733,1544.7018,1546.6302,1548.5587,1550.4872,1552.4156,1554.3441,1556.2726,1558.201,1560.1295,1562.058,1563.9865,1565.9149,1567.8434,1569.7719,1571.7003,1573.6288,1575.5573,1577.4857,1579.4142,1581.3427,1583.2711,1585.1996,1587.128,1589.0565,1590.985,1592.9135,1594.8419,1596.7704,1598.6989,1600.6273,1602.5558,1604.4843,1606.4127,1608.3412,1610.2697,1612.1981,1614.1266,1616.055,1617.9835,1619.912,1621.8405,1623.7689,1625.6974,1627.6259,1629.5543,1631.4828,1633.4113,1635.3397,1637.2682,1639.1967,1641.1251,1643.0536,1644.982,1646.9105,1648.839,1650.7675,1652.6959,1654.6244,1656.5529,1658.4813,1660.4098,1662.3383,1664.2667,1666.1952,1668.1237,1670.0521,1671.9806,1673.909,1675.8375,1677.766,1679.6945,1681.6229,1683.5514,1685.4799,1687.4083,1689.3368,1691.2653,1693.1937,1695.1222,1697.0507,1698.9791,1700.9076,1702.836,1704.7645,1706.693,1708.6215,1710.5499,1712.4784,1714.4069,1716.3353,1718.2638,1720.1923,1722.1207,1724.0492,1725.9777,1727.9061,1729.8346,1731.7631,1733.6915,1735.62,1737.5485,1739.4769,1741.4054,1743.3339,1745.2623,1747.1908,1749.1193,1751.0477,1752.9762,1754.9047,1756.8331,1758.7616,1760.6901,1762.6185,1764.547,1766.4755,1768.4039,1770.3324,1772.2609,1774.1893,1776.1178,1778.0463,1779.9747,1781.9032,1783.8317,1785.7601,1787.6886,1789.6171,1791.5455,1793.474,1795.4025,1797.3309,1799.2594,1801.1879,1803.1163,1805.0448,1806.9733,1808.9017,1810.8302,1812.7587,1814.6871,1816.6156,1818.5441,1820.4725,1822.401,1824.3295,1826.2579,1828.1864,1830.1149,1832.0433,1833.9718,1835.9003,1837.8287,1839.7572,1841.6857,1843.6141,1845.5426,1847.4711,1849.3995,1851.328,1853.2565,1855.1849,1857.1134,1859.0419,1860.9703,1862.8988,1864.8273,1866.7557,1868.6842,1870.6127,1872.5411,1874.4696,1876.3981,1878.3265,1880.255,1882.1835,1884.1119,1886.0404,1887.9689,1889.8973,1891.8258,1893.7543,1895.6827,1897.6112,1899.5397,1901.4681,1903.3966,1905.3251,1907.2535,1909.182,1911.1105,1913.039,1914.9674,1916.8959,1918.8243,1920.7528,1922.6813,1924.6097,1926.5382,1928.4667,1930.3951,1932.3236,1934.2521,1936.1805,1938.109,1940.0375,1941.966,1943.8944,1945.8229,1947.7513,1949.6798,1951.6083,1953.5367,1955.4652,1957.3937,1959.3221,1961.2506,1963.1791,1965.1075,1967.036,1968.9645,1970.893,1972.8214,1974.7499,1976.6783,1978.6068,1980.5353,1982.4637,1984.3922,1986.3207,1988.2491,1990.1776,1992.1061,1994.0345,1995.963,1997.8915,1999.82,2001.7484,2003.6769,2005.6053,2007.5338,2009.4623,2011.3907,2013.3192,2015.2477,2017.1761,2019.1046,2021.0331,2022.9615,2024.89,2026.8185,2028.747,2030.6754,2032.6039,2034.5323,2036.4608,2038.3893,2040.3177,2042.2462,2044.1747,2046.1031,2048.0315,2049.96,2051.8884,2053.817,2055.7454,2057.6738,2059.6023,2061.5308,2063.4592,2065.3877,2067.3162,2069.2446,2071.173,2073.1016,2075.03,2076.9585,2078.887,2080.8154,2082.744,2084.6724,2086.6008,2088.5293,2090.4578,2092.3862,2094.3147,2096.2432,2098.1716,2100.1,2102.0286,2103.957,2105.8855,2107.814,2109.7424,2111.671,2113.5994,2115.5278,2117.4563,2119.3848,2121.3132,2123.2417,2125.1702,2127.0986,2129.027,2130.9556,2132.884,2134.8125,2136.741,2138.6694,2140.598,2142.5264,2144.4548,2146.3833,2148.3118,2150.2402,2152.1687,2154.0972,2156.0256,2157.954,2159.8826,2161.811,2163.7395,2165.668,2167.5964,2169.525,2171.4534,2173.3818,2175.3103,2177.2388,2179.1672,2181.0957,2183.0242,2184.9526,2186.881,2188.8096,2190.738,2192.6665,2194.595,2196.5234,2198.452,2200.3804,2202.3088,2204.2373,2206.1658,2208.0942,2210.0227,2211.9512,2213.8796,2215.808,2217.7366,2219.665,2221.5935,2223.522,2225.4504,2227.379,2229.3074,2231.2358,2233.1643,2235.0928,2237.0212,2238.9497,2240.8782,2242.8066,2244.735,2246.6636,2248.592,2250.5205,2252.449,2254.3774,2256.306,2258.2344,2260.1628,2262.0913,2264.0198,2265.9482,2267.8767,2269.8052,2271.7336,2273.662,2275.5906,2277.519,2279.4475,2281.376,2283.3044,2285.233,2287.1614,2289.0898,2291.0183,2292.9468,2294.8752,2296.8037,2298.7322,2300.6606,2302.589,2304.5176,2306.446,2308.3745,2310.303,2312.2314,2314.16,2316.0884,2318.0168,2319.9453,2321.8738,2323.8022,2325.7307,2327.6592,2329.5876,2331.516,2333.4446,2335.373,2337.3015,2339.23,2341.1584,2343.087,2345.0154,2346.9438,2348.8723,2350.8008,2352.7292,2354.6577,2356.5862,2358.5146,2360.443,2362.3716,2364.3,2366.2285,2368.157,2370.0854,2372.014,2373.9424,2375.8708,2377.7993,2379.7278,2381.6562,2383.5847,2385.5132,2387.4417,2389.37,2391.2986,2393.227,2395.1555,2397.084,2399.0125,2400.941,2402.8694,2404.7979,2406.7263,2408.6548,2410.5833,2412.5117,2414.4402,2416.3687,2418.297,2420.2256,2422.154,2424.0825,2426.011,2427.9395,2429.868,2431.7964,2433.7249,2435.6533,2437.5818,2439.5103,2441.4387,2443.3672,2445.2957,2447.224,2449.1526,2451.081,2453.0095,2454.938,2456.8665,2458.795,2460.7234,2462.6519,2464.5803,2466.5088,2468.4373,2470.3657,2472.2942,2474.2227,2476.1511,2478.0796,2480.008,2481.9365,2483.865,2485.7935,2487.722,2489.6504,2491.5789,2493.5073,2495.4358,2497.3643,2499.2927,2501.2212,2503.1497,2505.0781,2507.0066,2508.935,2510.8635,2512.792,2514.7205,2516.649,2518.5774,2520.5059,2522.4343,2524.3628,2526.2913,2528.2197,2530.1482,2532.0767,2534.0051,2535.9336,2537.862,2539.7905,2541.719,2543.6475,2545.576,2547.5044,2549.4329,2551.3613,2553.2898,2555.2183,2557.1467,2559.0752,2561.0037,2562.9321,2564.8606,2566.789,2568.7175,2570.646,2572.5745,2574.503,2576.4314,2578.3599,2580.2883,2582.2168,2584.1453,2586.0737,2588.0022,2589.9307,2591.8591,2593.7876,2595.716,2597.6445,2599.573,2601.5015,2603.43,2605.3584,2607.2869,2609.2153,2611.1438,2613.0723,2615.0007,2616.9292,2618.8577,2620.7861,2622.7146,2624.643,2626.5715,2628.5,2630.4285,2632.357,2634.2854,2636.2139,2638.1423,2640.0708,2641.9993,2643.9277,2645.8562,2647.7847,2649.7131,2651.6416,2653.57,2655.4985,2657.427,2659.3555,2661.284,2663.2124,2665.1409,2667.0693,2668.9978,2670.9263,2672.8547,2674.7832,2676.7117,2678.6401,2680.5686,2682.497,2684.4255,2686.354,2688.2825,2690.211,2692.1394,2694.0679,2695.9963,2697.9248,2699.8533,2701.7817,2703.7102,2705.6387,2707.5671,2709.4956,2711.424,2713.3525,2715.281,2717.2095,2719.138,2721.0664,2722.9949,2724.9233,2726.8518,2728.7803,2730.7087,2732.6372,2734.5657,2736.4941,2738.4226,2740.351,2742.2795,2744.208,2746.1365,2748.065,2749.9934,2751.9219,2753.8503,2755.7788,2757.7073,2759.6357,2761.5642,2763.4927,2765.4211,2767.3496,2769.278,2771.2065,2773.135,2775.0635,2776.992,2778.9204,2780.8489,2782.7773,2784.7058,2786.6343,2788.5627,2790.4912,2792.4197,2794.3481,2796.2766,2798.205,2800.1335,2802.062,2803.9905,2805.919,2807.8474,2809.776,2811.7043,2813.6328,2815.5613,2817.4897,2819.4182,2821.3467,2823.2751,2825.2036,2827.132,2829.0605,2830.989,2832.9175,2834.846,2836.7744,2838.703,2840.6313,2842.5598,2844.4883,2846.4167,2848.3452,2850.2737,2852.2021,2854.1306,2856.059,2857.9875,2859.916,2861.8445,2863.773,2865.7014,2867.63,2869.5583,2871.4868,2873.4153,2875.3438,2877.2722,2879.2007,2881.1292,2883.0576,2884.986,2886.9146,2888.843,2890.7715,2892.7,2894.6284,2896.557,2898.4854,2900.4138,2902.3423,2904.2708,2906.1992,2908.1277,2910.0562,2911.9846,2913.913,2915.8416,2917.77,2919.6985,2921.627,2923.5554,2925.484,2927.4124,2929.3408,2931.2693,2933.1978,2935.1262,2937.0547,2938.9832,2940.9116,2942.84,2944.7686,2946.697,2948.6255,2950.554,2952.4824,2954.411,2956.3394,2958.2678,2960.1963,2962.1248,2964.0532,2965.9817,2967.9102,2969.8386,2971.767,2973.6956,2975.624,2977.5525,2979.481,2981.4094,2983.338,2985.2664,2987.1948,2989.1233,2991.0518,2992.9802,2994.9087,2996.8372,2998.7656,3000.694,3002.6226,3004.551,3006.4795,3008.408,3010.3364,3012.265,3014.1934,3016.1218,3018.0503,3019.9788,3021.9072,3023.8357,3025.7642,3027.6926,3029.621,3031.5496,3033.478,3035.4065,3037.335,3039.2634,3041.192,3043.1204,3045.0488,3046.9773,3048.9058,3050.8342,3052.7627,3054.6912,3056.6196,3058.548,3060.4766,3062.405,3064.3335,3066.262,3068.1904,3070.119,3072.0474,3073.9758,3075.9043,3077.8328,3079.7612,3081.6897,3083.6182,3085.5466,3087.475,3089.4036,3091.332,3093.2605,3095.189,3097.1174,3099.046,3100.9744,3102.9028,3104.8313,3106.7598,3108.6882,3110.6167,3112.5452,3114.4736,3116.402,3118.3306,3120.259,3122.1875,3124.116,3126.0444,3127.973,3129.9014,3131.8298,3133.7583,3135.6868,3137.6152,3139.5437,3141.4722,3143.4006,3145.329,3147.2576,3149.186,3151.1145,3153.043,3154.9714,3156.9,3158.8284,3160.7568,3162.6853,3164.6138,3166.5422,3168.4707,3170.3992,3172.3276,3174.256,3176.1846,3178.113,3180.0415,3181.97,3183.8984,3185.827,3187.7554,3189.6838,3191.6123,3193.5408,3195.4692,3197.3977,3199.3262,3201.2546,3203.183,3205.1116,3207.04,3208.9685,3210.897,3212.8254,3214.754,3216.6824,3218.6108,3220.5393,3222.4678,3224.3962,3226.3247,3228.2532,3230.1816,3232.11,3234.0386,3235.967,3237.8955,3239.824,3241.7524,3243.681,3245.6094,3247.5378,3249.4663,3251.3948,3253.3232,3255.2517,3257.1802,3259.1086,3261.037,3262.9656,3264.894,3266.8225,3268.751,3270.6794,3272.608,3274.5364,3276.4648,3278.3933,3280.3218,3282.2502,3284.1787,3286.1072,3288.0356,3289.964,3291.8926,3293.821,3295.7495,3297.678,3299.6064,3301.535,3303.4634,3305.3918,3307.3203,3309.2488,3311.1772,3313.1057,3315.0342,3316.9626,3318.891,3320.8196,3322.748,3324.6765,3326.605,3328.5334,3330.462,3332.3904,3334.3188,3336.2473,3338.1758,3340.1042,3342.0327,3343.9612,3345.8896,3347.818,3349.7466,3351.675,3353.6035,3355.532,3357.4604,3359.389,3361.3174,3363.2458,3365.1743,3367.1028,3369.0312,3370.9597,3372.8882,3374.8167,3376.745,3378.6736,3380.602,3382.5305,3384.459,3386.3875,3388.316,3390.2444,3392.1729,3394.1013,3396.0298,3397.9583,3399.8867,3401.8152,3403.7437,3405.672,3407.6006,3409.529,3411.4575,3413.386,3415.3145,3417.243,3419.1714,3421.0999,3423.0283,3424.9568,3426.8853,3428.8137,3430.7422,3432.6707,3434.599,3436.5276,3438.456,3440.3845,3442.313,3444.2415,3446.17,3448.0984,3450.0269,3451.9553,3453.8838,3455.8123,3457.7407,3459.6692,3461.5977,3463.5261,3465.4546,3467.383,3469.3115,3471.24,3473.1685,3475.097,3477.0254,3478.9539,3480.8823,3482.8108,3484.7393,3486.6677,3488.5962,3490.5247,3492.4531,3494.3816,3496.31,3498.2385,3500.167,3502.0955,3504.024,3505.9524,3507.8809,3509.8093,3511.7378,3513.6663,3515.5947,3517.5232,3519.4517,3521.3801,3523.3086,3525.237,3527.1655,3529.094,3531.0225,3532.951,3534.8794,3536.8079,3538.7363,3540.6648,3542.5933,3544.5217,3546.4502,3548.3787,3550.3071,3552.2356,3554.164,3556.0925,3558.021,3559.9495,3561.878,3563.8064,3565.7349,3567.6633,3569.5918,3571.5203,3573.4487,3575.3772,3577.3057,3579.2341,3581.1626,3583.091,3585.0195,3586.948,3588.8765,3590.805,3592.7334,3594.6619,3596.5903,3598.5188,3600.4473,3602.3757,3604.3042,3606.2327,3608.1611,3610.0896,3612.018,3613.9465,3615.875,3617.8035,3619.732,3621.6604,3623.5889,3625.5173,3627.4458,3629.3743,3631.3027,3633.2312,3635.1597,3637.0881,3639.0166,3640.945,3642.8735,3644.802,3646.7305,3648.659,3650.5874,3652.5159,3654.4443,3656.3728,3658.3013,3660.2297,3662.1582,3664.0867,3666.0151,3667.9436,3669.872,3671.8005,3673.729,3675.6575,3677.586,3679.5144,3681.4429,3683.3713,3685.2998,3687.2283,3689.1567,3691.0852,3693.0137,3694.9421,3696.8706,3698.799,3700.7275,3702.656,3704.5845,3706.513,3708.4414,3710.3699,3712.2983,3714.2268,3716.1553,3718.0837,3720.0122,3721.9407,3723.8691,3725.7976,3727.726,3729.6545,3731.583,3733.5115,3735.44,3737.3684,3739.2969,3741.2253,3743.1538,3745.0823,3747.0107,3748.9392,3750.8677,3752.7961,3754.7246,3756.653,3758.5815,3760.51,3762.4385,3764.367,3766.2954,3768.2239,3770.1523,3772.0808,3774.0093,3775.9377,3777.8662,3779.7947,3781.7231,3783.6516,3785.58,3787.5085,3789.437,3791.3655,3793.294,3795.2224,3797.151,3799.0793,3801.0078,3802.9363,3804.8647,3806.7932,3808.7217,3810.6501,3812.5786,3814.507,3816.4355,3818.364,3820.2925,3822.221,3824.1494,3826.078,3828.0063,3829.9348,3831.8633,3833.7917,3835.7202,3837.6487,3839.5771,3841.5056,3843.434,3845.3625,3847.291,3849.2195,3851.148,3853.0764,3855.005,3856.9333,3858.8618,3860.7903,3862.7188,3864.6472,3866.5757,3868.5042,3870.4326,3872.361,3874.2896,3876.218,3878.1465,3880.075,3882.0034,3883.932,3885.8604,3887.7888,3889.7173,3891.6458,3893.5742,3895.5027,3897.4312,3899.3596,3901.288,3903.2166,3905.145,3907.0735,3909.002,3910.9304,3912.859,3914.7874,3916.7158,3918.6443,3920.5728,3922.5012,3924.4297,3926.3582,3928.2866,3930.215,3932.1436,3934.072,3936.0005,3937.929,3939.8574,3941.786,3943.7144,3945.6428,3947.5713,3949.4998,3951.4282,3953.3567,3955.2852,3957.2136,3959.142,3961.0706,3962.999,3964.9275,3966.856,3968.7844,3970.713,3972.6414,3974.5698,3976.4983,3978.4268,3980.3552,3982.2837,3984.2122,3986.1406,3988.069,3989.9976,3991.926,3993.8545,3995.783,3997.7114,3999.64]
_test_data_y = [0.008680129,0.008150327,0.002573062,-0.009089184,0.0017715943,0.019238312,0.010343855,0.003930265,0.020122154,0.008167076,-0.008154798,0.0012311976,0.004680542,0.00730168,0.014106006,0.010673578,0.004040694,0.0014862982,-0.0006048443,0.0023423068,0.005854856,0.008465349,0.008393163,0.011563962,0.020087395,0.0021241338,-0.0080654165,-0.005756053,-0.007537591,-0.0043900004,0.008746102,0.005859579,0.0047000363,0.009215655,-0.0015251088,-0.017531293,-0.01081148,0.005081204,-0.004309631,-0.014910872,-0.0057160985,-0.008393686,-0.0109226145,-0.010225397,2.6766917e-05,0.005955724,0.007566246,0.00056079315,-0.0184642,-0.02011929,-0.0118719265,-0.010746887,-0.0038469618,0.0008215689,-0.00038284,-0.0059778304,-0.00011207178,0.004882856,0.0036983178,0.004333347,0.0035215288,0.0010902346,-0.005116494,-0.007902103,-0.00353439,-0.0024629899,-0.004551822,-0.0020311226,0.008389362,0.012422799,0.009809347,0.0009931627,0.002318936,-0.0052629565,-0.005667607,-0.002184347,0.0014722721,0.004659583,0.004597576,0.005114494,0.0063958126,0.006968561,0.0027136216,2.1692984e-05,0.0037290212,0.006824909,0.008962528,0.0071421014,0.006463017,0.012739337,0.015884466,0.015363482,0.015406231,0.0118147535,0.0073195286,0.007122971,0.009960479,0.004219655,0.0021441642,0.0049593826,0.01896984,0.017259981,0.012618173,0.009471601,0.01311581,0.014636489,0.013757637,0.014680051,0.021718847,0.025745973,0.020180507,0.019288452,0.02991588,0.044281635,0.050002076,0.043634813,0.043519396,0.04354578,0.038351215,0.030464182,0.028772973,0.024578933,0.022069607,0.024077734,0.026633319,0.023233,0.023576649,0.029386884,0.030262724,0.03042742,0.032851946,0.032340445,0.031304836,0.032777295,0.0346001,0.03464291,0.038952947,0.040285002,0.037018754,0.041545637,0.04624636,0.043985803,0.04290245,0.04223591,0.048233464,0.05252223,0.049299676,0.047496114,0.051730417,0.05276571,0.054532047,0.057800345,0.062147602,0.06670126,0.070206545,0.07081096,0.07320955,0.07853022,0.0860574,0.09184792,0.096013404,0.09866759,0.10237938,0.10711939,0.11342942,0.117072225,0.12348218,0.12821846,0.12905678,0.13307439,0.14203565,0.15547046,0.16635758,0.17213899,0.18081358,0.18337123,0.1885984,0.1959544,0.20395862,0.21034336,0.22286223,0.23516805,0.23619327,0.24445811,0.26934284,0.2767953,0.28350687,0.29459432,0.3035747,0.31628516,0.32638553,0.332647,0.33998787,0.34947416,0.35871348,0.36276373,0.3689013,0.3819902,0.3901829,0.3957549,0.39902914,0.39928538,0.39832157,0.39384347,0.3922717,0.39497352,0.39499268,0.39064586,0.39142013,0.391928,0.39518693,0.39868936,0.39881364,0.40133932,0.39522454,0.39023358,0.3914161,0.3840823,0.3806639,0.37959185,0.37603506,0.36781168,0.3575228,0.349637,0.34640262,0.3398791,0.32686108,0.31378645,0.30640745,0.3001551,0.29352355,0.2805408,0.26591676,0.25543284,0.25243095,0.2434238,0.2423942,0.2463205,0.24099454,0.23286025,0.22939768,0.22684893,0.22319703,0.215922,0.20791161,0.20584883,0.2073287,0.20731005,0.20627119,0.2068866,0.2035588,0.1998175,0.19880833,0.19393419,0.18967174,0.18964823,0.1916764,0.18935493,0.18949735,0.18832982,0.18639526,0.18445738,0.18232605,0.17960042,0.17621917,0.17295605,0.17144495,0.16358455,0.15564987,0.14699982,0.13638858,0.12964208,0.12553373,0.1204617,0.11674878,0.11027586,0.10360235,0.09828741,0.095812015,0.095937364,0.09860216,0.100991115,0.10409201,0.105689794,0.11135618,0.116278954,0.11703277,0.11831371,0.1230521,0.12682332,0.13171662,0.1342677,0.13634627,0.14101501,0.14327613,0.1442886,0.1483858,0.15274166,0.153326,0.15388322,0.1565602,0.15791006,0.15882935,0.15847151,0.15959783,0.15862079,0.15781024,0.15710631,0.1578882,0.15898277,0.15835387,0.15736787,0.1582968,0.15775158,0.15736999,0.15820703,0.1597963,0.15815799,0.15602076,0.15552646,0.1552757,0.15359886,0.15162624,0.15036109,0.14939383,0.14663666,0.1466342,0.14547275,0.14465778,0.14250566,0.13913612,0.1363709,0.13435355,0.1347166,0.13343951,0.12805708,0.12505496,0.12697767,0.12744457,0.12662429,0.12586157,0.12641132,0.12591937,0.12538241,0.12720983,0.12702605,0.12507634,0.12447204,0.12528063,0.1261286,0.12596542,0.123995855,0.12545446,0.12787923,0.12876676,0.12908053,0.12974817,0.13045968,0.13224025,0.13242252,0.13224941,0.13345954,0.13447747,0.13486797,0.13608103,0.13762666,0.13731787,0.13651334,0.13868755,0.14242114,0.14516275,0.14641216,0.14732045,0.14932832,0.15249883,0.15439619,0.15374574,0.15261365,0.15287322,0.15434588,0.15421306,0.15357184,0.1575191,0.15955204,0.15795189,0.15908256,0.16160648,0.16396461,0.16618182,0.16769038,0.167987,0.16851284,0.1702273,0.17106442,0.1700736,0.16917647,0.16969718,0.17137781,0.17227395,0.17220132,0.1683727,0.16729595,0.16680546,0.16049072,0.1577537,0.15589383,0.15340851,0.15183325,0.15247548,0.15020168,0.14792138,0.14482392,0.14325935,0.141569,0.1412471,0.13857691,0.13558416,0.13323872,0.13474806,0.13154435,0.12281903,0.116187245,0.11364374,0.11129864,0.10633558,0.10001513,0.097749814,0.094817035,0.08639146,0.08100139,0.07737741,0.074782915,0.072042845,0.073110744,0.07680559,0.07720792,0.07850907,0.08175365,0.08681643,0.09246181,0.09534421,0.09787371,0.1026122,0.108542904,0.1148906,0.11838523,0.11965254,0.124534205,0.13234107,0.13401821,0.13521937,0.13816212,0.14154588,0.14412212,0.14379267,0.14502782,0.14746165,0.1488965,0.14990649,0.15525201,0.15603055,0.15440191,0.15315357,0.1529651,0.15318903,0.15248477,0.14795661,0.14462437,0.14110212,0.13852982,0.1357717,0.1296445,0.12760536,0.12349989,0.117497675,0.115925,0.115177356,0.114149645,0.11549652,0.11578341,0.118053064,0.11782429,0.1129998,0.11013863,0.1131694,0.11796822,0.11938541,0.120830044,0.123186104,0.12609275,0.1299941,0.13201731,0.13343905,0.13811554,0.14274131,0.14524975,0.14717977,0.15123159,0.1570248,0.16197851,0.16536553,0.1725252,0.17910513,0.18392569,0.19217373,0.20323215,0.21150462,0.2188368,0.22967894,0.24274997,0.25429657,0.26386794,0.26658493,0.26663104,0.26730758,0.2657917,0.26080388,0.25699314,0.2559445,0.25223273,0.24865215,0.2486681,0.24727081,0.2448417,0.2393055,0.23310357,0.22623871,0.2170851,0.20840997,0.1998405,0.18964146,0.18281332,0.17522793,0.15693332,0.1439409,0.13793477,0.13585736,0.123418406,0.107986964,0.09693292,0.08820559,0.07965688,0.07556461,0.065565355,0.062949955,0.057307884,0.034537062,0.023956375,0.01827985,0.011243737,0.0051320167,0.0013688045,0.0012437622,0.003870321,0.0037107188,-0.0052605523,-0.010362109,-0.010685315,-0.01137771,-0.013522524,-0.015862247,-0.012659141,-0.0024338004,-0.006970354,-0.016912589,-0.015228262,-0.018803993,-0.024447631,-0.027276998,-0.029289002,-0.028524067,-0.026052766,-0.030691272,-0.035651244,-0.03531016,-0.037881248,-0.037871,-0.037641194,-0.040740915,-0.040787622,-0.03970046,-0.039317146,-0.035901982,-0.040114496,-0.044473,-0.045381237,-0.04527998,-0.04496267,-0.043774907,-0.04342567,-0.045652475,-0.045904398,-0.041919556,-0.041800044,-0.04681992,-0.046257883,-0.045751173,-0.04625067,-0.048116475,-0.047849044,-0.047036376,-0.046937503,-0.046716116,-0.04621609,-0.04639525,-0.04630079,-0.046696264,-0.047427233,-0.04815823,-0.045602556,-0.045282498,-0.046710677,-0.0439817,-0.04409865,-0.04555841,-0.04555655,-0.045583304,-0.046442054,-0.04700966,-0.04289806,-0.0425407,-0.045911107,-0.045781042,-0.045543123,-0.045312677,-0.04500482,-0.044635132,-0.04429711,-0.04331951,-0.042551123,-0.04303921,-0.043020736,-0.040062144,-0.039952036,-0.04122977,-0.040561385,-0.04037423,-0.040891066,-0.040362388,-0.04031903,-0.039773926,-0.038568407,-0.038063977,-0.037366375,-0.037413403,-0.03795213,-0.036761515,-0.035632405,-0.03587262,-0.036159433,-0.03676323,-0.03664091,-0.03631027,-0.035490397,-0.034734596,-0.034496572,-0.034584213,-0.03204224,-0.030300163,-0.032795776,-0.033107754,-0.032118406,-0.031405065,-0.031138126,-0.031081595,-0.031621538,-0.03164633,-0.030841608,-0.030218942,-0.029576087,-0.029022455,-0.028828226,-0.028436258,-0.026584726,-0.026549954,-0.026488878,-0.026848199,-0.02643247,-0.026239565,-0.02635949,-0.026660299,-0.027727328,-0.027738743,-0.026225675,-0.024813974,-0.024709126,-0.024501411,-0.024602346,-0.023739263,-0.022174884,-0.021690635,-0.020858603,-0.020643655,-0.020492166,-0.021123746,-0.020927629,-0.020233555,-0.020145783,-0.019653575,-0.020254506,-0.021207523,-0.020340772,-0.019033182,-0.019595481,-0.019422684,-0.017288424,-0.016832411,-0.017526818,-0.016634846,-0.017032327,-0.017110577,-0.015642716,-0.014219282,-0.014704172,-0.014718034,-0.0142654255,-0.015081572,-0.0136137,-0.012460773,-0.011412709,-0.011797061,-0.0132252285,-0.013298442,-0.012537686,-0.010252652,-0.007827872,-0.013482876,-0.0133370515,0.0066065756,-0.0024331824,-0.012490252,-0.011158421,-0.013561716,-0.012957428,-0.011544511,-0.010196725,-0.008818261,-0.009126751,-0.009105408,-0.0071898317,-0.0075077736,-0.008744441,-0.007982268,-0.005884373,-0.0051967143,-0.0045322506,-0.0040499177,-0.0039053033,-0.0038990437,-0.004550592,-0.005096897,-0.0056161964,-0.0052834153,-0.005395717,-0.0060007065,-0.005309857,-0.004082025,-0.0036752266,-0.00444335,-0.0044687665,-0.003342033,-0.0025498266,-0.0024623207,-0.0028698451,-0.002577516,-0.0020055112,-0.002722213,-0.0030017968,-0.0028477807,-0.0029192674,-0.0018373767,-0.0011613987,-0.0010318306,-0.000970622,-0.0010390613,-0.002196555,-0.0023058986,-0.002176929,-0.0014723802,-0.0013441434,-0.001566534,-0.0009890113,0.0034324436,0.0038443345,2.384163e-05,-0.0031971824,-0.004342129,-0.0009746512,0.0006657017,0.0008409427,0.0007175302,0.0014696228,0.0021036882,0.0016967184,0.001543862,0.0028326001,0.0015732703,0.00012740353,0.0010627793,0.0021229892,0.0012360261,0.00092763,0.0022804993,0.002720238,0.0029512462,0.0028460969,0.0030837941,0.002435177,0.0020481308,0.003161126,0.0032471302,0.003772704,0.0052779666,0.0050804447,0.0042949407,0.00423973,0.0036581142,0.0034777666,0.004053836,0.0048519657,0.005616241,0.0055742078,0.004633445,0.0049298224,0.0053678765,0.005118894,0.005063997,0.004694358,0.005120597,0.00671866,0.007347856,0.0076899873,0.008252125,0.007866558,0.0066550965,0.0061777215,0.0073605464,0.008070361,0.008679416,0.008375349,0.007073977,0.0077899117,0.0075519173,0.0077226344,0.008261148,0.008201315,0.008722754,0.008897103,0.009226813,0.009563654,0.009121746,0.008557954,0.008489844,0.0083866175,0.009344521,0.010632114,0.010284397,0.0100117065,0.010539038,0.011476429,0.010895824,0.01041146,0.011241692,0.011618969,0.011074101,0.010880827,0.011187318,0.011639469,0.011751317,0.011149416,0.010963117,0.011950753,0.012449677,0.012388784,0.011657018,0.011335848,0.011233457,0.011005091,0.012021936,0.012979765,0.012918506,0.013611133,0.0141664175,0.0139076905,0.013738774,0.013138622,0.012845976,0.013142571,0.013372678,0.013617357,0.012966003,0.013055412,0.0141204735,0.014547477,0.0145849,0.014638282,0.015126501,0.015047572,0.015005902,0.015151375,0.015379251,0.015470982,0.016414735,0.016593572,0.016280044,0.016186181,0.01583689,0.015374932,0.015873995,0.016501656,0.0165631,0.01653207,0.016806921,0.017162351,0.016416563,0.016376913,0.016995206,0.017171266,0.0168186,0.016097253,0.016640827,0.016890045,0.016989553,0.017246379,0.016816393,0.016822204,0.017074328,0.016480576,0.01678604,0.017198008,0.017125972,0.017189227,0.016937872,0.016863188,0.016951464,0.017199947,0.01758117,0.017765908,0.018662754,0.019281281,0.018430827,0.017437333,0.017724652,0.017802099,0.017270245,0.017597588,0.018141098,0.018173866,0.018230796,0.017853344,0.01727353,0.017302595,0.01741788,0.01788725,0.017974008,0.017318085,0.017722359,0.017950859,0.017574836,0.016639024,0.016091425,0.01660675,0.017494868,0.018108442,0.018254364,0.017976409,0.017382879,0.017266607,0.017333737,0.017237572,0.01771292,0.01801019,0.017736893,0.017503493,0.01707912,0.016191985,0.015792863,0.015939407,0.016314715,0.016711652,0.016248979,0.01588632,0.016207542,0.015424121,0.014732455,0.015225497,0.015738588,0.014794399,0.014165241,0.014554892,0.014501546,0.014614347,0.01438203,0.014247407,0.013953585,0.014014456,0.014018146,0.01415901,0.013727018,0.01296395,0.012917225,0.013504653,0.013466282,0.012798785,0.012765061,0.013462037,0.013915281,0.01382909,0.013779493,0.013946796,0.01335183,0.0127622085,0.013157859,0.013653444,0.013618345,0.013489513,0.01326276,0.012881626,0.012635656,0.013044635,0.013044288,0.013003984,0.012882266,0.013021588,0.013091906,0.013433948,0.013593078,0.01317088,0.012446933,0.012530826,0.012494059,0.013031431,0.013902585,0.013346998,0.012823206,0.013037219,0.012978138,0.013141717,0.013122641,0.012824779,0.012603783,0.012587794,0.012250705,0.012736831,0.013302154,0.013250003,0.013202261,0.013101884,0.013040873,0.012843923,0.013026309,0.013428929,0.013008438,0.012287291,0.012111124,0.012869334,0.013340324,0.013528046,0.013606273,0.01333632,0.013263907,0.01321016,0.01338341,0.013306932,0.012996435,0.01316373,0.013510608,0.013734205,0.013881577,0.013907717,0.013316968,0.013343821,0.014012773,0.014179309,0.014309657,0.014611028,0.014621951,0.014279186,0.014189873,0.014620612,0.015161695,0.015037201,0.014510887,0.014142937,0.01415342,0.0148110045,0.014840308,0.014527482,0.014442693,0.014001116,0.01422451,0.014796435,0.014938435,0.014995077,0.015201933,0.014791533,0.014357146,0.014806103,0.014888257,0.014295906,0.01420437,0.015385446,0.015381289,0.015295127,0.015599062,0.015515969,0.015851576,0.016565414,0.016901484,0.017439408,0.017263133,0.016632462,0.016723623,0.01706959,0.017539635,0.017876163,0.01801151,0.018887613,0.01947511,0.020054646,0.020341882,0.020469591,0.021056786,0.022328611,0.02298672,0.0238027,0.024623202,0.02520669,0.026302451,0.027588623,0.028427316,0.02901038,0.030276407,0.03183208,0.03355585,0.03570119,0.038386475,0.041630156,0.045341082,0.04962498,0.054894395,0.05949632,0.062111553,0.06305736,0.06353062,0.063157104,0.062097818,0.061549723,0.062170304,0.06316887,0.0648452,0.06686429,0.06918528,0.07140807,0.072686516,0.07303209,0.07346916,0.074548446,0.07598034,0.07777513,0.07870023,0.07951453,0.080579355,0.08268608,0.08477948,0.08717229,0.08930818,0.09087766,0.09268305,0.09525407,0.09790588,0.100149356,0.10301475,0.10687915,0.111769974,0.117072694,0.12200056,0.12629393,0.1296445,0.131939,0.13200203,0.13169995,0.13076548,0.12925749,0.12731886,0.123674,0.11963437,0.11497573,0.10937207,0.10539514,0.10213795,0.09812913,0.09511735,0.09337155,0.091557994,0.09026789,0.08930465,0.08749549,0.086346425,0.08497093,0.08209723,0.078997776,0.075982966,0.07355173,0.07128619,0.06847543,0.06596358,0.063425876,0.059799436,0.056365333,0.05303851,0.05007603,0.047297597,0.044240676,0.04174838,0.039746378,0.037735183,0.036139634,0.034584012,0.032519657,0.031404,0.030938033,0.03028776,0.02966035,0.028985444,0.028970502,0.02928073,0.029653892,0.029602014,0.029944196,0.030231168,0.030611178,0.03162776,0.03275728,0.033589046,0.03417651,0.034262437,0.034999553,0.035074197,0.03510333,0.035967216,0.03654977,0.03775156,0.039478708,0.04010128,0.041249923,0.04267729,0.04294174,0.04378937,0.04515475,0.046722278,0.047394708,0.047816716,0.048390884,0.049345728,0.050603166,0.051267914,0.05158595,0.051949233,0.052868962,0.054153636,0.05496493,0.054921802,0.055059478,0.055635158,0.056501757,0.056641586,0.057053994,0.05759508,0.058136962,0.058823314,0.05904425,0.059106532,0.06005226,0.060702678,0.060800273,0.06162397,0.062987685,0.063908055,0.064546674,0.064952895,0.06587714,0.06759313,0.06855339,0.06948066,0.070185944,0.07041977,0.07165532,0.0734416,0.075313464,0.07741741,0.078832716,0.07968207,0.08083922,0.0820532,0.08389341,0.08590333,0.08715018,0.08795238,0.09005877,0.09271147,0.09481858,0.09667726,0.098297246,0.09970092,0.10170768,0.10375929,0.10593096,0.107888654,0.11023372,0.11251143,0.11465576,0.11690763,0.119661786,0.121635474,0.12309419,0.1253043,0.12817231,0.13035779,0.13240254,0.13411793,0.13617407,0.13865855,0.14112538,0.14387281,0.14560196,0.14702648,0.14975849,0.15262182,0.15457183,0.15663902,0.15971698,0.16163318,0.16264643,0.16508897,0.16792847,0.17002788,0.17264287,0.17501353,0.177871,0.18066762,0.18372537,0.1865922,0.1896645,0.19222847,0.19459532,0.19728054,0.20104167,0.20421065,0.20736647,0.2103047,0.2138326,0.21802923,0.2214848,0.22523336,0.22803813,0.23192686,0.23647843,0.23963471,0.2425192,0.24505846,0.24785228,0.25002444,0.2524822,0.25463715,0.25649643,0.25834638,0.26118895,0.26346102,0.2646053,0.26546657,0.26708004,0.269255,0.27024388,0.2701404,0.27133462,0.271727,0.27155626,0.27133983,0.27273345,0.27442774,0.2741387,0.27366796,0.27360725,0.2745831,0.2751536,0.27427384,0.2748144,0.27543002,0.27505544,0.2751581,0.27547783,0.27645656,0.27709162,0.27620775,0.2764703,0.27735624,0.27669087,0.2758222,0.27542114,0.275164,0.27551925,0.2759433,0.27522522,0.2741314,0.27373534,0.27354035,0.27390972,0.27331713,0.27307644,0.27323687,0.2717359,0.2694837,0.2696337,0.27007714,0.26939586,0.26866424,0.26831675,0.2681976,0.26804963,0.2670224,0.26689926,0.26639754,0.26537165,0.2647594,0.26352793,0.26313844,0.26317972,0.26310623,0.26341236,0.26150614,0.26068673,0.2598984,0.25889704,0.25782043,0.2566903,0.25573125,0.2549809,0.25425795,0.2526582,0.2505655,0.24932788,0.24757278,0.24640591,0.2452716,0.24293476,0.240906,0.239629,0.2381174,0.23663308,0.23498116,0.23376136,0.2322649,0.23052539,0.22784977,0.22546518,0.2237222,0.22189286,0.21998803,0.2182942,0.21540335,0.21227008,0.20964755,0.208176,0.20637788,0.20363207,0.20105639,0.19840372,0.196229,0.19445588,0.19227219,0.1891248,0.18550651,0.18229103,0.17991626,0.17804457,0.17541529,0.17246652,0.16952185,0.16640766,0.16326052,0.16033724,0.15712701,0.15446176,0.15225367,0.14974341,0.14570585,0.14253636,0.14016534,0.13718593,0.13424715,0.13093317,0.1276571,0.12489818,0.12197115,0.11836361,0.115242966,0.11276937,0.10970432,0.10672628,0.10458802,0.10241533,0.09927107,0.09633675,0.09367142,0.091417745,0.08850842,0.08577703,0.0833845,0.0809672,0.077990375,0.07513788,0.072758466,0.06993066,0.06681501,0.06482287,0.062375262,0.05963201,0.056425847,0.05423936,0.052201644,0.050512254,0.048870984,0.047348257,0.044937145,0.042382807,0.040513188,0.038851563,0.03705165,0.034729324,0.03290955,0.031886067,0.029616285,0.027654056,0.026139367,0.024081264,0.02237614,0.021089721,0.02011665,0.019229274,0.01774954,0.016475549,0.0148835415,0.013669954,0.012148497,0.010576939,0.009777628,0.009177661,0.008351969,0.007400778,0.0067375097,0.005827754,0.004670075,0.0045200926,0.0054831803,0.004987792,0.0035792585,0.0008766064,-0.00088667235,0.00015065657,0.00013659585,-0.0010207258,-0.0018225291,-0.0024407504,-0.0025299592,-0.0027615693,-0.003239322,-0.0027977843,-0.0024598497,-0.002646989,-0.0030851844,-0.0041996115,-0.005663161,-0.0061958707,-0.0058190427,-0.005318142,-0.0046985773,-0.005180497,-0.00661699,-0.0069808997,-0.006494599,-0.0066194884,-0.006540857,-0.0065700775,-0.0067519373,-0.006515816,-0.0064149755,-0.0056714904,-0.0058773756,-0.0070107025,-0.0077458485,-0.0076152286,-0.007156222,-0.006552025,-0.0067297122,-0.0069554257,-0.008015153,-0.008233037,-0.007219722,-0.006539378,-0.006435176,-0.0070539,-0.007475359,-0.0076872576,-0.008343005,-0.008042851,-0.0072652916,-0.0071346797,-0.0062734936,-0.005457992,-0.005929572,-0.0062345564,-0.0058665983,-0.0057782256,-0.0061786193,-0.005960213,-0.0060349163,-0.0061915326,-0.005928959,-0.006147024,-0.0065142857,-0.0061530983,-0.005734952,-0.0062891594,-0.006567732,-0.0062074563,-0.006659513,-0.007287438,-0.0062456816,-0.00578359,-0.0068299705,-0.0068018883,-0.006719619,-0.006685565,-0.006659411,-0.0067341984,-0.006803825,-0.006528923,-0.006803825,-0.0073355967,-0.006979626,-0.007136106,-0.0073260264,-0.0066639488,-0.007436173,-0.009237252,-0.0091191465,-0.007674287,-0.0077292686,-0.008113184,-0.0077167065,-0.007250221,-0.008008088,-0.008322943,-0.008171666,-0.008227195,-0.0076724556,-0.0078613795,-0.008391706,-0.008331374,-0.008743782,-0.009057546,-0.008570368,-0.008437306,-0.008750074,-0.0084283175,-0.008568744,-0.008673603,-0.00856113,-0.008721202,-0.008225925,-0.00860798,-0.008718665,-0.008111252,-0.008101394,-0.008624121,-0.009121782,-0.009678624,-0.00950609,-0.009557498,-0.010126122,-0.009723936,-0.009309064,-0.008909619,-0.009363788,-0.010202136,-0.010332132,-0.010554262,-0.010725017,-0.01045562,-0.0105749285,-0.010772038,-0.010443843,-0.010399465,-0.010871721,-0.010880759,-0.011123098,-0.011515118,-0.01151295,-0.0116671,-0.0118796835,-0.011998855,-0.012224263,-0.012317423,-0.012888228,-0.012687299,-0.0118600875,-0.011794239,-0.012209666,-0.013157879,-0.013647516,-0.013126637,-0.013241047,-0.013256614,-0.012668343,-0.012830075,-0.013655694,-0.014069144,-0.014093803,-0.013947933,-0.013775282,-0.013399554,-0.014089643,-0.014490813,-0.014651667,-0.014417149,-0.014184208,-0.014184709,-0.014353241,-0.014831326,-0.015538827,-0.015790764,-0.015324528,-0.014898466,-0.015512801,-0.01575252,-0.015334674,-0.015713274]


@pytest.mark.parametrize("filter", tested_filters)
def test_filter(filter):
    # test with default parameters and many anchors
    background = filter(_test_data_x,
                        _test_data_y,
                        [record['x'] for record in _test_parameter_set['anchor_points']],
                        [(record['region_min'], record['region_max']) for record in _test_parameter_set['anchor_regions']],
                        _test_parameter_set['map_mask'])

    assert len(background) == len(_test_data_x)

    # test with default parameters and no anchors
    background = filter(_test_data_x,
                        _test_data_y,
                        [],
                        [],
                        None)

    assert len(background) == len(_test_data_x)
